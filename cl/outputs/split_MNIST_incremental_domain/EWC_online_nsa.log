split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	12.1047 (12.1047)	0.5213 (0.5213)	42.915 (42.915)	17.19 (17.19)
[98/99]	0.0318 (0.1552)	0.0012 (0.0067)	7.336 (11.846)	47.93 (78.33)
 * Train Acc 78.326
 * Val Acc 53.664, Total time 0.32
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1375 (0.1375)	0.1037 (0.1037)	7.335 (7.335)	57.81 (57.81)
[98/99]	0.0326 (0.0345)	0.0013 (0.0025)	6.754 (7.043)	100.00 (81.47)
 * Train Acc 81.469
 * Val Acc 99.905, Total time 0.31
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1359 (0.1359)	0.1019 (0.1019)	6.756 (6.756)	100.00 (100.00)
[98/99]	0.0330 (0.0351)	0.0011 (0.0023)	6.622 (6.644)	100.00 (99.83)
 * Train Acc 99.826
 * Val Acc 99.953, Total time 0.32
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1424 (0.1424)	0.1067 (0.1067)	6.627 (6.627)	100.00 (100.00)
[98/99]	0.0324 (0.0359)	0.0011 (0.0024)	6.608 (6.621)	100.00 (99.87)
 * Train Acc 99.866
 * Val Acc 99.953, Total time 1.09
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.953, Total time 0.36
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1655 (0.1655)	0.1175 (0.1175)	14.899 (14.899)	44.53 (44.53)
[94/95]	0.0386 (0.0452)	0.0012 (0.0027)	13.438 (13.633)	98.25 (92.32)
 * Train Acc 92.315
 * Val Acc 97.062, Total time 0.31
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1373 (0.1373)	0.0879 (0.0879)	13.485 (13.485)	95.31 (95.31)
[94/95]	0.0389 (0.0448)	0.0012 (0.0024)	13.376 (13.433)	98.25 (96.91)
 * Train Acc 96.906
 * Val Acc 97.307, Total time 0.32
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1786 (0.1786)	0.1333 (0.1333)	13.384 (13.384)	98.44 (98.44)
[94/95]	0.0406 (0.0463)	0.0013 (0.0034)	13.384 (13.392)	98.25 (97.15)
 * Train Acc 97.146
 * Val Acc 97.747, Total time 0.36
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.2097 (0.2097)	0.1587 (0.1587)	13.413 (13.413)	96.88 (96.88)
[94/95]	0.0429 (0.0477)	0.0024 (0.0033)	13.449 (13.410)	94.74 (97.34)
 * Train Acc 97.345
 * Val Acc 97.698, Total time 0.35
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 78.629, Total time 0.32
validation split name: 2
 * Val Acc 97.698, Total time 0.31
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1339 (0.1339)	0.0895 (0.0895)	13.906 (13.906)	73.44 (73.44)
[87/88]	0.0420 (0.0442)	0.0016 (0.0024)	13.442 (13.577)	98.43 (92.19)
 * Train Acc 92.187
 * Val Acc 96.265, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1267 (0.1267)	0.0822 (0.0822)	13.470 (13.470)	96.09 (96.09)
[87/88]	0.0435 (0.0439)	0.0014 (0.0024)	13.399 (13.468)	96.85 (96.16)
 * Train Acc 96.156
 * Val Acc 96.692, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1280 (0.1280)	0.0835 (0.0835)	13.500 (13.500)	92.97 (92.97)
[87/88]	0.0411 (0.0433)	0.0013 (0.0024)	13.419 (13.442)	96.85 (96.65)
 * Train Acc 96.653
 * Val Acc 96.958, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1298 (0.1298)	0.0811 (0.0811)	13.483 (13.483)	96.88 (96.88)
[87/88]	0.0424 (0.0434)	0.0016 (0.0024)	13.437 (13.435)	96.06 (96.81)
 * Train Acc 96.813
 * Val Acc 97.065, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 67.612, Total time 0.29
validation split name: 2
 * Val Acc 89.471, Total time 0.29
validation split name: 3
 * Val Acc 97.065, Total time 0.30
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1281 (0.1281)	0.0831 (0.0831)	14.691 (14.691)	51.56 (51.56)
[95/96]	0.0380 (0.0434)	0.0014 (0.0023)	13.335 (13.483)	100.00 (96.95)
 * Train Acc 96.947
 * Val Acc 98.137, Total time 0.34
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1696 (0.1696)	0.1168 (0.1168)	13.393 (13.393)	100.00 (100.00)
[95/96]	0.0368 (0.0441)	0.0012 (0.0028)	13.305 (13.365)	100.00 (98.95)
 * Train Acc 98.949
 * Val Acc 98.590, Total time 0.33
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1517 (0.1517)	0.1060 (0.1060)	13.346 (13.346)	99.22 (99.22)
[95/96]	0.0378 (0.0439)	0.0015 (0.0027)	13.327 (13.336)	100.00 (99.13)
 * Train Acc 99.130
 * Val Acc 98.540, Total time 0.29
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1386 (0.1386)	0.0911 (0.0911)	13.322 (13.322)	99.22 (99.22)
[95/96]	0.0383 (0.0436)	0.0016 (0.0023)	13.318 (13.337)	100.00 (99.23)
 * Train Acc 99.228
 * Val Acc 98.640, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 79.102, Total time 0.32
validation split name: 2
 * Val Acc 92.801, Total time 0.29
validation split name: 3
 * Val Acc 70.224, Total time 0.28
validation split name: 4
 * Val Acc 98.640, Total time 0.30
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1325 (0.1325)	0.0877 (0.0877)	15.262 (15.262)	54.69 (54.69)
[92/93]	0.0377 (0.0438)	0.0016 (0.0024)	13.478 (13.630)	91.67 (93.42)
 * Train Acc 93.424
 * Val Acc 95.663, Total time 0.30
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1448 (0.1448)	0.0992 (0.0992)	13.437 (13.437)	99.22 (99.22)
[92/93]	0.0371 (0.0434)	0.0014 (0.0025)	13.516 (13.474)	95.83 (95.64)
 * Train Acc 95.636
 * Val Acc 95.411, Total time 0.30
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1405 (0.1405)	0.0974 (0.0974)	13.533 (13.533)	95.31 (95.31)
[92/93]	0.0397 (0.0438)	0.0013 (0.0025)	13.551 (13.464)	91.67 (95.88)
 * Train Acc 95.881
 * Val Acc 95.512, Total time 0.31
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1360 (0.1360)	0.0918 (0.0918)	13.427 (13.427)	96.88 (96.88)
[92/93]	0.0361 (0.0428)	0.0011 (0.0023)	13.453 (13.459)	91.67 (95.89)
 * Train Acc 95.890
 * Val Acc 95.966, Total time 0.29
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 59.905, Total time 0.29
validation split name: 2
 * Val Acc 74.241, Total time 0.30
validation split name: 3
 * Val Acc 29.562, Total time 0.29
validation split name: 4
 * Val Acc 93.656, Total time 0.28
validation split name: 5
 * Val Acc 95.966, Total time 0.29
OrderedDict([('1', OrderedDict([('1', 99.95271867612293), ('2', 78.62884160756501), ('3', 67.61229314420804), ('4', 79.10165484633569), ('5', 59.90543735224586)])), ('2', OrderedDict([('2', 97.69833496571988), ('3', 89.47110675808031), ('4', 92.80117531831537), ('5', 74.2409402546523)])), ('3', OrderedDict([('3', 97.06510138740661), ('4', 70.22411953041622), ('5', 29.562433297758805)])), ('4', OrderedDict([('4', 98.6404833836858), ('5', 93.65558912386707)])), ('5', OrderedDict([('5', 95.96570852244075)]))])
Task 1 average acc: 99.95271867612293
Task 2 average acc: 88.16358828664244
Task 3 average acc: 84.716167096565
Task 4 average acc: 85.19185826968827
Task 5 average acc: 70.66602171019296
===Summary of experiment repeats: 1 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171  0.          0.          0.          0.          0.
  0.          0.          0.          0.        ]
mean: 7.066602171019296 std: 21.19980651305789
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1276 (0.1276)	0.0936 (0.0936)	42.863 (42.863)	35.94 (35.94)
[98/99]	0.0329 (0.0351)	0.0012 (0.0024)	7.343 (11.838)	67.77 (50.49)
 * Train Acc 50.493
 * Val Acc 69.882, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1196 (0.1196)	0.0852 (0.0852)	7.355 (7.355)	69.53 (69.53)
[98/99]	0.0337 (0.0351)	0.0015 (0.0022)	7.060 (7.281)	86.78 (55.74)
 * Train Acc 55.736
 * Val Acc 89.409, Total time 0.30
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1138 (0.1138)	0.0798 (0.0798)	6.994 (6.994)	90.62 (90.62)
[98/99]	0.0326 (0.0349)	0.0011 (0.0021)	6.639 (6.897)	100.00 (98.69)
 * Train Acc 98.689
 * Val Acc 99.811, Total time 0.31
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1217 (0.1217)	0.0885 (0.0885)	6.637 (6.637)	100.00 (100.00)
[98/99]	0.0330 (0.0350)	0.0012 (0.0024)	6.642 (6.630)	100.00 (99.83)
 * Train Acc 99.834
 * Val Acc 99.905, Total time 0.31
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.905, Total time 0.27
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1149 (0.1149)	0.0718 (0.0718)	14.458 (14.458)	50.78 (50.78)
[94/95]	0.0342 (0.0397)	0.0011 (0.0022)	13.373 (13.570)	100.00 (92.20)
 * Train Acc 92.200
 * Val Acc 97.160, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1209 (0.1209)	0.0788 (0.0788)	13.425 (13.425)	95.31 (95.31)
[94/95]	0.0341 (0.0397)	0.0012 (0.0022)	13.462 (13.403)	91.23 (97.09)
 * Train Acc 97.088
 * Val Acc 97.502, Total time 0.25
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1183 (0.1183)	0.0776 (0.0776)	13.449 (13.449)	96.09 (96.09)
[94/95]	0.0342 (0.0394)	0.0012 (0.0023)	13.401 (13.366)	94.74 (97.42)
 * Train Acc 97.419
 * Val Acc 97.747, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1207 (0.1207)	0.0800 (0.0800)	13.353 (13.353)	98.44 (98.44)
[94/95]	0.0345 (0.0395)	0.0016 (0.0023)	13.351 (13.364)	96.49 (97.61)
 * Train Acc 97.609
 * Val Acc 97.992, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 74.846, Total time 0.29
validation split name: 2
 * Val Acc 97.992, Total time 0.27
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1147 (0.1147)	0.0736 (0.0736)	14.108 (14.108)	69.53 (69.53)
[87/88]	0.0378 (0.0396)	0.0012 (0.0023)	13.441 (13.584)	98.43 (92.36)
 * Train Acc 92.356
 * Val Acc 96.265, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1138 (0.1138)	0.0734 (0.0734)	13.458 (13.458)	96.88 (96.88)
[87/88]	0.0378 (0.0397)	0.0012 (0.0022)	13.507 (13.474)	96.85 (96.51)
 * Train Acc 96.511
 * Val Acc 97.279, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1172 (0.1172)	0.0755 (0.0755)	13.473 (13.473)	96.09 (96.09)
[87/88]	0.0378 (0.0397)	0.0012 (0.0024)	13.416 (13.435)	98.43 (97.23)
 * Train Acc 97.230
 * Val Acc 97.332, Total time 0.25
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1287 (0.1287)	0.0860 (0.0860)	13.406 (13.406)	96.88 (96.88)
[87/88]	0.0378 (0.0394)	0.0014 (0.0022)	13.373 (13.415)	99.21 (97.47)
 * Train Acc 97.470
 * Val Acc 97.332, Total time 0.25
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 57.352, Total time 0.28
validation split name: 2
 * Val Acc 90.010, Total time 0.26
validation split name: 3
 * Val Acc 97.332, Total time 0.24
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1233 (0.1233)	0.0817 (0.0817)	14.212 (14.212)	58.59 (58.59)
[95/96]	0.0343 (0.0395)	0.0012 (0.0023)	13.362 (13.433)	100.00 (97.44)
 * Train Acc 97.439
 * Val Acc 98.489, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1166 (0.1166)	0.0760 (0.0760)	13.392 (13.392)	99.22 (99.22)
[95/96]	0.0342 (0.0396)	0.0012 (0.0023)	13.293 (13.352)	100.00 (99.15)
 * Train Acc 99.155
 * Val Acc 99.043, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1212 (0.1212)	0.0789 (0.0789)	13.350 (13.350)	100.00 (100.00)
[95/96]	0.0341 (0.0396)	0.0012 (0.0022)	13.318 (13.326)	100.00 (99.30)
 * Train Acc 99.302
 * Val Acc 98.590, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1334 (0.1334)	0.0914 (0.0914)	13.328 (13.328)	100.00 (100.00)
[95/96]	0.0346 (0.0400)	0.0013 (0.0024)	13.406 (13.325)	95.65 (99.32)
 * Train Acc 99.319
 * Val Acc 98.691, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 72.482, Total time 0.28
validation split name: 2
 * Val Acc 94.172, Total time 0.26
validation split name: 3
 * Val Acc 67.396, Total time 0.26
validation split name: 4
 * Val Acc 98.691, Total time 0.28
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1132 (0.1132)	0.0711 (0.0711)	14.810 (14.810)	53.91 (53.91)
[92/93]	0.0342 (0.0395)	0.0012 (0.0022)	13.435 (13.563)	100.00 (94.40)
 * Train Acc 94.398
 * Val Acc 95.613, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1199 (0.1199)	0.0778 (0.0778)	13.432 (13.432)	96.88 (96.88)
[92/93]	0.0344 (0.0395)	0.0012 (0.0022)	13.381 (13.455)	100.00 (96.31)
 * Train Acc 96.314
 * Val Acc 96.067, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1224 (0.1224)	0.0822 (0.0822)	13.557 (13.557)	93.75 (93.75)
[92/93]	0.0340 (0.0391)	0.0010 (0.0021)	13.549 (13.454)	87.50 (96.36)
 * Train Acc 96.364
 * Val Acc 96.319, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1231 (0.1231)	0.0811 (0.0811)	13.493 (13.493)	94.53 (94.53)
[92/93]	0.0278 (0.0390)	0.0011 (0.0022)	13.367 (13.455)	100.00 (96.36)
 * Train Acc 96.364
 * Val Acc 96.520, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 57.258, Total time 0.30
validation split name: 2
 * Val Acc 70.323, Total time 0.28
validation split name: 3
 * Val Acc 26.041, Total time 0.26
validation split name: 4
 * Val Acc 90.383, Total time 0.26
validation split name: 5
 * Val Acc 96.520, Total time 0.26
OrderedDict([('1', OrderedDict([('1', 99.90543735224587), ('2', 74.84633569739952), ('3', 57.35224586288416), ('4', 72.48226950354609), ('5', 57.25768321513002)])), ('2', OrderedDict([('2', 97.99216454456415), ('3', 90.00979431929481), ('4', 94.17238001958864), ('5', 70.3232125367287)])), ('3', OrderedDict([('3', 97.33191035218783), ('4', 67.39594450373532), ('5', 26.040554962646745)])), ('4', OrderedDict([('4', 98.6908358509567), ('5', 90.38267875125881)])), ('5', OrderedDict([('5', 96.52042360060514)]))])
Task 1 average acc: 99.90543735224587
Task 2 average acc: 86.41925012098184
Task 3 average acc: 81.56465017812228
Task 4 average acc: 83.18535746945669
Task 5 average acc: 68.10491061327389
===Summary of experiment repeats: 2 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061  0.          0.          0.          0.
  0.          0.          0.          0.        ]
mean: 13.877093232346686 std: 27.760094214888877
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1140 (0.1140)	0.0834 (0.0834)	43.357 (43.357)	92.97 (92.97)
[98/99]	0.0293 (0.0315)	0.0012 (0.0022)	6.767 (11.849)	100.00 (98.07)
 * Train Acc 98.066
 * Val Acc 99.811, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1101 (0.1101)	0.0787 (0.0787)	6.739 (6.739)	100.00 (100.00)
[98/99]	0.0292 (0.0315)	0.0011 (0.0022)	6.638 (6.674)	100.00 (99.80)
 * Train Acc 99.803
 * Val Acc 99.905, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1137 (0.1137)	0.0824 (0.0824)	6.634 (6.634)	100.00 (100.00)
[98/99]	0.0292 (0.0315)	0.0012 (0.0022)	6.629 (6.632)	99.17 (99.85)
 * Train Acc 99.850
 * Val Acc 99.905, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1120 (0.1120)	0.0804 (0.0804)	6.630 (6.630)	100.00 (100.00)
[98/99]	0.0293 (0.0316)	0.0012 (0.0023)	6.625 (6.623)	100.00 (99.89)
 * Train Acc 99.889
 * Val Acc 99.953, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.953, Total time 0.28
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1227 (0.1227)	0.0828 (0.0828)	14.695 (14.695)	49.22 (49.22)
[94/95]	0.0341 (0.0393)	0.0012 (0.0023)	13.411 (13.623)	100.00 (91.89)
 * Train Acc 91.885
 * Val Acc 97.013, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1286 (0.1286)	0.0874 (0.0874)	13.431 (13.431)	97.66 (97.66)
[94/95]	0.0342 (0.0393)	0.0012 (0.0022)	13.331 (13.416)	100.00 (97.03)
 * Train Acc 97.030
 * Val Acc 97.600, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1126 (0.1126)	0.0720 (0.0720)	13.394 (13.394)	96.88 (96.88)
[94/95]	0.0344 (0.0393)	0.0012 (0.0022)	13.432 (13.382)	96.49 (97.29)
 * Train Acc 97.287
 * Val Acc 97.551, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1176 (0.1176)	0.0775 (0.0775)	13.407 (13.407)	96.88 (96.88)
[94/95]	0.0343 (0.0392)	0.0011 (0.0021)	13.394 (13.374)	96.49 (97.46)
 * Train Acc 97.461
 * Val Acc 97.894, Total time 0.25
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 73.381, Total time 0.29
validation split name: 2
 * Val Acc 97.894, Total time 0.27
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1155 (0.1155)	0.0728 (0.0728)	14.067 (14.067)	70.31 (70.31)
[87/88]	0.0380 (0.0394)	0.0012 (0.0021)	13.481 (13.579)	96.06 (91.51)
 * Train Acc 91.512
 * Val Acc 95.678, Total time 0.24
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1220 (0.1220)	0.0809 (0.0809)	13.533 (13.533)	93.75 (93.75)
[87/88]	0.0384 (0.0394)	0.0012 (0.0022)	13.413 (13.450)	97.64 (96.23)
 * Train Acc 96.227
 * Val Acc 97.012, Total time 0.24
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1188 (0.1188)	0.0775 (0.0775)	13.402 (13.402)	99.22 (99.22)
[87/88]	0.0379 (0.0395)	0.0013 (0.0023)	13.400 (13.407)	98.43 (97.07)
 * Train Acc 97.070
 * Val Acc 97.385, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1163 (0.1163)	0.0756 (0.0756)	13.392 (13.392)	97.66 (97.66)
[87/88]	0.0378 (0.0395)	0.0012 (0.0023)	13.377 (13.398)	100.00 (97.21)
 * Train Acc 97.212
 * Val Acc 97.385, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 62.648, Total time 0.29
validation split name: 2
 * Val Acc 86.680, Total time 0.27
validation split name: 3
 * Val Acc 97.385, Total time 0.27
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1388 (0.1388)	0.0958 (0.0958)	14.763 (14.763)	39.06 (39.06)
[95/96]	0.0344 (0.0400)	0.0012 (0.0024)	13.361 (13.468)	100.00 (96.97)
 * Train Acc 96.971
 * Val Acc 98.036, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1199 (0.1199)	0.0792 (0.0792)	13.379 (13.379)	98.44 (98.44)
[95/96]	0.0339 (0.0394)	0.0012 (0.0023)	13.373 (13.366)	100.00 (99.01)
 * Train Acc 99.007
 * Val Acc 98.439, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1228 (0.1228)	0.0804 (0.0804)	13.387 (13.387)	98.44 (98.44)
[95/96]	0.0346 (0.0396)	0.0013 (0.0022)	13.401 (13.351)	95.65 (99.20)
 * Train Acc 99.196
 * Val Acc 98.640, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1455 (0.1455)	0.1037 (0.1037)	13.390 (13.390)	96.09 (96.09)
[95/96]	0.0342 (0.0396)	0.0012 (0.0024)	13.341 (13.368)	100.00 (99.26)
 * Train Acc 99.261
 * Val Acc 98.238, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 74.894, Total time 0.27
validation split name: 2
 * Val Acc 93.683, Total time 0.28
validation split name: 3
 * Val Acc 73.052, Total time 0.27
validation split name: 4
 * Val Acc 98.238, Total time 0.25
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1313 (0.1313)	0.0907 (0.0907)	14.836 (14.836)	53.91 (53.91)
[92/93]	0.0338 (0.0394)	0.0013 (0.0024)	13.417 (13.593)	100.00 (93.61)
 * Train Acc 93.610
 * Val Acc 95.209, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1163 (0.1163)	0.0735 (0.0735)	13.515 (13.515)	93.75 (93.75)
[92/93]	0.0344 (0.0391)	0.0013 (0.0022)	13.430 (13.478)	95.83 (95.70)
 * Train Acc 95.703
 * Val Acc 95.461, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1195 (0.1195)	0.0782 (0.0782)	13.425 (13.425)	98.44 (98.44)
[92/93]	0.0342 (0.0394)	0.0013 (0.0022)	13.402 (13.482)	100.00 (95.64)
 * Train Acc 95.636
 * Val Acc 96.016, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1146 (0.1146)	0.0726 (0.0726)	13.469 (13.469)	95.31 (95.31)
[92/93]	0.0344 (0.0397)	0.0012 (0.0022)	13.413 (13.482)	100.00 (95.55)
 * Train Acc 95.551
 * Val Acc 95.361, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 62.884, Total time 0.28
validation split name: 2
 * Val Acc 75.220, Total time 0.26
validation split name: 3
 * Val Acc 35.272, Total time 0.25
validation split name: 4
 * Val Acc 96.224, Total time 0.27
validation split name: 5
 * Val Acc 95.361, Total time 0.26
OrderedDict([('1', OrderedDict([('1', 99.95271867612293), ('2', 73.3806146572104), ('3', 62.64775413711584), ('4', 74.8936170212766), ('5', 62.88416075650118)])), ('2', OrderedDict([('2', 97.89422135161607), ('3', 86.67972575905975), ('4', 93.68266405484819), ('5', 75.2203721841332)])), ('3', OrderedDict([('3', 97.38527214514407), ('4', 73.05229455709711), ('5', 35.27214514407684)])), ('4', OrderedDict([('4', 98.23766364551864), ('5', 96.22356495468279)])), ('5', OrderedDict([('5', 95.36056480080686)]))])
Task 1 average acc: 99.95271867612293
Task 2 average acc: 85.63741800441323
Task 3 average acc: 82.23758401377323
Task 4 average acc: 84.96655981968513
Task 5 average acc: 72.99216156804017
===Summary of experiment repeats: 3 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157  0.          0.          0.
  0.          0.          0.          0.        ]
mean: 21.176309389150703 std: 32.36581581068528
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1074 (0.1074)	0.0761 (0.0761)	42.710 (42.710)	45.31 (45.31)
[98/99]	0.0295 (0.0314)	0.0014 (0.0020)	7.335 (11.809)	97.52 (83.08)
 * Train Acc 83.079
 * Val Acc 95.887, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1123 (0.1123)	0.0806 (0.0806)	7.335 (7.335)	95.31 (95.31)
[98/99]	0.0295 (0.0316)	0.0014 (0.0022)	7.031 (7.215)	96.69 (72.10)
 * Train Acc 72.096
 * Val Acc 98.960, Total time 0.28
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1062 (0.1062)	0.0737 (0.0737)	6.998 (6.998)	97.66 (97.66)
[98/99]	0.0293 (0.0316)	0.0012 (0.0021)	6.626 (6.831)	100.00 (99.49)
 * Train Acc 99.487
 * Val Acc 99.905, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1040 (0.1040)	0.0729 (0.0729)	6.632 (6.632)	100.00 (100.00)
[98/99]	0.0293 (0.0316)	0.0012 (0.0022)	6.619 (6.624)	100.00 (99.84)
 * Train Acc 99.842
 * Val Acc 99.905, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.905, Total time 0.29
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1177 (0.1177)	0.0740 (0.0740)	14.543 (14.543)	56.25 (56.25)
[94/95]	0.0344 (0.0394)	0.0012 (0.0022)	13.386 (13.609)	96.49 (92.62)
 * Train Acc 92.621
 * Val Acc 97.062, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1150 (0.1150)	0.0742 (0.0742)	13.451 (13.451)	98.44 (98.44)
[94/95]	0.0339 (0.0391)	0.0010 (0.0020)	13.406 (13.416)	96.49 (97.00)
 * Train Acc 96.997
 * Val Acc 97.405, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1170 (0.1170)	0.0763 (0.0763)	13.383 (13.383)	96.88 (96.88)
[94/95]	0.0345 (0.0393)	0.0012 (0.0022)	13.403 (13.381)	98.25 (97.29)
 * Train Acc 97.287
 * Val Acc 97.845, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1253 (0.1253)	0.0842 (0.0842)	13.363 (13.363)	95.31 (95.31)
[94/95]	0.0338 (0.0392)	0.0014 (0.0023)	13.404 (13.363)	96.49 (97.50)
 * Train Acc 97.502
 * Val Acc 97.600, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 83.215, Total time 0.28
validation split name: 2
 * Val Acc 97.600, Total time 0.28
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1483 (0.1483)	0.1045 (0.1045)	14.169 (14.169)	66.41 (66.41)
[87/88]	0.0378 (0.0398)	0.0012 (0.0026)	13.493 (13.595)	94.49 (91.68)
 * Train Acc 91.681
 * Val Acc 95.891, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1215 (0.1215)	0.0784 (0.0784)	13.494 (13.494)	95.31 (95.31)
[87/88]	0.0380 (0.0397)	0.0013 (0.0022)	13.473 (13.477)	97.64 (95.90)
 * Train Acc 95.898
 * Val Acc 96.692, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1138 (0.1138)	0.0724 (0.0724)	13.479 (13.479)	95.31 (95.31)
[87/88]	0.0374 (0.0397)	0.0010 (0.0022)	13.491 (13.449)	96.06 (96.57)
 * Train Acc 96.573
 * Val Acc 96.531, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1219 (0.1219)	0.0802 (0.0802)	13.416 (13.416)	98.44 (98.44)
[87/88]	0.0378 (0.0394)	0.0013 (0.0023)	13.450 (13.448)	96.06 (96.57)
 * Train Acc 96.573
 * Val Acc 96.638, Total time 0.25
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 63.641, Total time 0.27
validation split name: 2
 * Val Acc 88.639, Total time 0.26
validation split name: 3
 * Val Acc 96.638, Total time 0.26
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1171 (0.1171)	0.0758 (0.0758)	14.408 (14.408)	48.44 (48.44)
[95/96]	0.0343 (0.0397)	0.0012 (0.0022)	13.335 (13.466)	100.00 (96.88)
 * Train Acc 96.881
 * Val Acc 97.936, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1360 (0.1360)	0.0937 (0.0937)	13.378 (13.378)	100.00 (100.00)
[95/96]	0.0343 (0.0396)	0.0012 (0.0023)	13.371 (13.367)	100.00 (98.93)
 * Train Acc 98.933
 * Val Acc 98.338, Total time 0.28
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1141 (0.1141)	0.0718 (0.0718)	13.393 (13.393)	97.66 (97.66)
[95/96]	0.0343 (0.0395)	0.0013 (0.0022)	13.338 (13.350)	100.00 (99.14)
 * Train Acc 99.138
 * Val Acc 98.741, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1235 (0.1235)	0.0806 (0.0806)	13.383 (13.383)	98.44 (98.44)
[95/96]	0.0343 (0.0397)	0.0012 (0.0023)	13.382 (13.343)	100.00 (99.22)
 * Train Acc 99.220
 * Val Acc 98.439, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 77.967, Total time 0.29
validation split name: 2
 * Val Acc 92.948, Total time 0.27
validation split name: 3
 * Val Acc 74.867, Total time 0.27
validation split name: 4
 * Val Acc 98.439, Total time 0.28
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1204 (0.1204)	0.0801 (0.0801)	15.396 (15.396)	45.31 (45.31)
[92/93]	0.0340 (0.0392)	0.0013 (0.0023)	13.456 (13.627)	100.00 (93.22)
 * Train Acc 93.220
 * Val Acc 94.554, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1321 (0.1321)	0.0903 (0.0903)	13.527 (13.527)	92.97 (92.97)
[92/93]	0.0344 (0.0396)	0.0012 (0.0024)	13.420 (13.508)	100.00 (95.30)
 * Train Acc 95.297
 * Val Acc 95.108, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1307 (0.1307)	0.0886 (0.0886)	13.483 (13.483)	94.53 (94.53)
[92/93]	0.0343 (0.0394)	0.0012 (0.0022)	13.423 (13.491)	100.00 (95.30)
 * Train Acc 95.297
 * Val Acc 94.907, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1205 (0.1205)	0.0780 (0.0780)	13.559 (13.559)	93.75 (93.75)
[92/93]	0.0342 (0.0397)	0.0012 (0.0023)	13.370 (13.474)	100.00 (95.03)
 * Train Acc 95.025
 * Val Acc 94.705, Total time 0.29
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 65.532, Total time 0.31
validation split name: 2
 * Val Acc 75.808, Total time 0.27
validation split name: 3
 * Val Acc 32.764, Total time 0.27
validation split name: 4
 * Val Acc 95.217, Total time 0.27
validation split name: 5
 * Val Acc 94.705, Total time 0.28
OrderedDict([('1', OrderedDict([('1', 99.90543735224587), ('2', 83.21513002364067), ('3', 63.64066193853428), ('4', 77.96690307328605), ('5', 65.53191489361703)])), ('2', OrderedDict([('2', 97.60039177277179), ('3', 88.63858961802154), ('4', 92.94809010773751), ('5', 75.80803134182175)])), ('3', OrderedDict([('3', 96.63820704375667), ('4', 74.8665955176094), ('5', 32.76414087513341)])), ('4', OrderedDict([('4', 98.43907351460221), ('5', 95.21651560926486)])), ('5', OrderedDict([('5', 94.70499243570347)]))])
Task 1 average acc: 99.90543735224587
Task 2 average acc: 90.40776089820622
Task 3 average acc: 82.97248620010417
Task 4 average acc: 86.0551655533088
Task 5 average acc: 72.80511903110812
===Summary of experiment repeats: 4 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157 72.80511903  0.          0.
  0.          0.          0.          0.        ]
mean: 28.456821292261516 std: 34.87477555612238
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1058 (0.1058)	0.0758 (0.0758)	43.525 (43.525)	44.53 (44.53)
[98/99]	0.0293 (0.0314)	0.0011 (0.0020)	7.351 (12.013)	49.59 (46.83)
 * Train Acc 46.830
 * Val Acc 46.336, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1175 (0.1175)	0.0857 (0.0857)	7.351 (7.351)	46.88 (46.88)
[98/99]	0.0292 (0.0317)	0.0012 (0.0023)	6.902 (7.122)	99.17 (66.06)
 * Train Acc 66.056
 * Val Acc 99.291, Total time 0.29
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1137 (0.1137)	0.0824 (0.0824)	6.975 (6.975)	100.00 (100.00)
[98/99]	0.0294 (0.0315)	0.0014 (0.0022)	6.643 (6.845)	100.00 (99.49)
 * Train Acc 99.495
 * Val Acc 99.905, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1032 (0.1032)	0.0719 (0.0719)	6.635 (6.635)	100.00 (100.00)
[98/99]	0.0293 (0.0315)	0.0012 (0.0021)	6.622 (6.632)	100.00 (99.85)
 * Train Acc 99.850
 * Val Acc 99.905, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.905, Total time 0.28
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1196 (0.1196)	0.0774 (0.0774)	14.584 (14.584)	45.31 (45.31)
[94/95]	0.0339 (0.0393)	0.0010 (0.0021)	13.408 (13.601)	96.49 (92.73)
 * Train Acc 92.729
 * Val Acc 97.160, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1138 (0.1138)	0.0718 (0.0718)	13.457 (13.457)	95.31 (95.31)
[94/95]	0.0342 (0.0392)	0.0011 (0.0020)	13.402 (13.406)	96.49 (96.96)
 * Train Acc 96.964
 * Val Acc 97.600, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1278 (0.1278)	0.0870 (0.0870)	13.398 (13.398)	95.31 (95.31)
[94/95]	0.0337 (0.0392)	0.0014 (0.0022)	13.419 (13.395)	92.98 (97.30)
 * Train Acc 97.295
 * Val Acc 97.747, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1130 (0.1130)	0.0722 (0.0722)	13.320 (13.320)	99.22 (99.22)
[94/95]	0.0341 (0.0387)	0.0012 (0.0021)	13.377 (13.376)	96.49 (97.48)
 * Train Acc 97.477
 * Val Acc 97.894, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 75.745, Total time 0.27
validation split name: 2
 * Val Acc 97.894, Total time 0.27
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1430 (0.1430)	0.1016 (0.1016)	14.165 (14.165)	70.31 (70.31)
[87/88]	0.0377 (0.0396)	0.0012 (0.0024)	13.506 (13.581)	92.91 (91.60)
 * Train Acc 91.601
 * Val Acc 95.998, Total time 0.25
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1183 (0.1183)	0.0771 (0.0771)	13.496 (13.496)	97.66 (97.66)
[87/88]	0.0379 (0.0393)	0.0012 (0.0022)	13.487 (13.463)	93.70 (96.09)
 * Train Acc 96.093
 * Val Acc 96.692, Total time 0.28
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1178 (0.1178)	0.0759 (0.0759)	13.404 (13.404)	98.44 (98.44)
[87/88]	0.0375 (0.0392)	0.0012 (0.0022)	13.409 (13.447)	97.64 (96.95)
 * Train Acc 96.946
 * Val Acc 96.958, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1227 (0.1227)	0.0797 (0.0797)	13.413 (13.413)	97.66 (97.66)
[87/88]	0.0375 (0.0394)	0.0010 (0.0022)	13.434 (13.453)	99.21 (96.84)
 * Train Acc 96.839
 * Val Acc 97.172, Total time 0.24
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 57.730, Total time 0.28
validation split name: 2
 * Val Acc 90.940, Total time 0.26
validation split name: 3
 * Val Acc 97.172, Total time 0.27
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1219 (0.1219)	0.0787 (0.0787)	14.493 (14.493)	46.09 (46.09)
[95/96]	0.0344 (0.0395)	0.0012 (0.0022)	13.346 (13.459)	100.00 (97.05)
 * Train Acc 97.053
 * Val Acc 98.187, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1196 (0.1196)	0.0780 (0.0780)	13.359 (13.359)	99.22 (99.22)
[95/96]	0.0342 (0.0395)	0.0012 (0.0022)	13.349 (13.352)	100.00 (99.08)
 * Train Acc 99.081
 * Val Acc 98.792, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1209 (0.1209)	0.0791 (0.0791)	13.349 (13.349)	100.00 (100.00)
[95/96]	0.0342 (0.0396)	0.0012 (0.0022)	13.313 (13.358)	100.00 (99.16)
 * Train Acc 99.163
 * Val Acc 98.338, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1327 (0.1327)	0.0919 (0.0919)	13.328 (13.328)	99.22 (99.22)
[95/96]	0.0344 (0.0396)	0.0012 (0.0023)	13.322 (13.338)	100.00 (99.24)
 * Train Acc 99.245
 * Val Acc 98.741, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 76.785, Total time 0.28
validation split name: 2
 * Val Acc 93.389, Total time 0.26
validation split name: 3
 * Val Acc 69.957, Total time 0.25
validation split name: 4
 * Val Acc 98.741, Total time 0.26
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1183 (0.1183)	0.0759 (0.0759)	15.110 (15.110)	50.00 (50.00)
[92/93]	0.0344 (0.0397)	0.0012 (0.0022)	13.492 (13.585)	95.83 (93.94)
 * Train Acc 93.941
 * Val Acc 95.108, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1498 (0.1498)	0.1089 (0.1089)	13.532 (13.532)	96.88 (96.88)
[92/93]	0.0345 (0.0399)	0.0012 (0.0026)	13.400 (13.468)	95.83 (95.67)
 * Train Acc 95.669
 * Val Acc 95.310, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1448 (0.1448)	0.1030 (0.1030)	13.455 (13.455)	95.31 (95.31)
[92/93]	0.0341 (0.0396)	0.0011 (0.0025)	13.406 (13.467)	100.00 (95.59)
 * Train Acc 95.593
 * Val Acc 95.461, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1182 (0.1182)	0.0770 (0.0770)	13.456 (13.456)	94.53 (94.53)
[92/93]	0.0333 (0.0390)	0.0009 (0.0022)	13.412 (13.465)	100.00 (95.53)
 * Train Acc 95.525
 * Val Acc 95.310, Total time 0.25
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 60.284, Total time 0.28
validation split name: 2
 * Val Acc 72.478, Total time 0.26
validation split name: 3
 * Val Acc 29.723, Total time 0.25
validation split name: 4
 * Val Acc 92.548, Total time 0.28
validation split name: 5
 * Val Acc 95.310, Total time 0.25
OrderedDict([('1', OrderedDict([('1', 99.90543735224587), ('2', 75.74468085106383), ('3', 57.730496453900706), ('4', 76.78486997635933), ('5', 60.283687943262414)])), ('2', OrderedDict([('2', 97.89422135161607), ('3', 90.94025465230166), ('4', 93.38883447600392), ('5', 72.47796278158668)])), ('3', OrderedDict([('3', 97.1718249733191), ('4', 69.95731056563501), ('5', 29.722518676627534)])), ('4', OrderedDict([('4', 98.7411883182276), ('5', 92.54783484390735)])), ('5', OrderedDict([('5', 95.31013615733737)]))])
Task 1 average acc: 99.90543735224587
Task 2 average acc: 86.81945110133995
Task 3 average acc: 81.9475253598405
Task 4 average acc: 84.71805083405647
Task 5 average acc: 70.06842808054427
===Summary of experiment repeats: 5 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157 72.80511903 70.06842808  0.
  0.          0.          0.          0.        ]
mean: 35.46366410031594 std: 35.48700660942568
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1058 (0.1058)	0.0742 (0.0742)	42.831 (42.831)	58.59 (58.59)
[98/99]	0.0293 (0.0315)	0.0012 (0.0020)	7.350 (11.833)	51.24 (57.00)
 * Train Acc 57.000
 * Val Acc 49.598, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1034 (0.1034)	0.0720 (0.0720)	7.336 (7.336)	52.34 (52.34)
[98/99]	0.0293 (0.0315)	0.0012 (0.0021)	7.307 (7.323)	74.38 (62.12)
 * Train Acc 62.124
 * Val Acc 76.265, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1166 (0.1166)	0.0852 (0.0852)	7.312 (7.312)	80.47 (80.47)
[98/99]	0.0292 (0.0316)	0.0011 (0.0023)	6.866 (7.089)	100.00 (81.33)
 * Train Acc 81.334
 * Val Acc 99.858, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1034 (0.1034)	0.0716 (0.0716)	6.876 (6.876)	98.44 (98.44)
[98/99]	0.0292 (0.0315)	0.0011 (0.0021)	6.622 (6.649)	100.00 (99.81)
 * Train Acc 99.811
 * Val Acc 99.905, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.905, Total time 0.28
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1160 (0.1160)	0.0719 (0.0719)	14.816 (14.816)	43.75 (43.75)
[94/95]	0.0343 (0.0393)	0.0012 (0.0021)	13.410 (13.597)	96.49 (92.61)
 * Train Acc 92.613
 * Val Acc 96.866, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1210 (0.1210)	0.0802 (0.0802)	13.408 (13.408)	97.66 (97.66)
[94/95]	0.0343 (0.0393)	0.0012 (0.0022)	13.361 (13.410)	98.25 (97.07)
 * Train Acc 97.072
 * Val Acc 97.209, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1203 (0.1203)	0.0788 (0.0788)	13.400 (13.400)	97.66 (97.66)
[94/95]	0.0345 (0.0393)	0.0012 (0.0022)	13.395 (13.383)	98.25 (97.31)
 * Train Acc 97.312
 * Val Acc 97.845, Total time 0.25
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1240 (0.1240)	0.0809 (0.0809)	13.356 (13.356)	96.88 (96.88)
[94/95]	0.0344 (0.0395)	0.0012 (0.0022)	13.415 (13.377)	98.25 (97.47)
 * Train Acc 97.469
 * Val Acc 97.894, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 77.163, Total time 0.28
validation split name: 2
 * Val Acc 97.894, Total time 0.26
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1192 (0.1192)	0.0778 (0.0778)	14.029 (14.029)	75.78 (75.78)
[87/88]	0.0379 (0.0396)	0.0012 (0.0023)	13.471 (13.563)	97.64 (92.67)
 * Train Acc 92.666
 * Val Acc 96.371, Total time 0.24
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1122 (0.1122)	0.0712 (0.0712)	13.484 (13.484)	96.88 (96.88)
[87/88]	0.0377 (0.0393)	0.0010 (0.0021)	13.463 (13.477)	96.85 (96.37)
 * Train Acc 96.369
 * Val Acc 96.638, Total time 0.25
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1239 (0.1239)	0.0828 (0.0828)	13.465 (13.465)	95.31 (95.31)
[87/88]	0.0379 (0.0396)	0.0012 (0.0024)	13.409 (13.450)	97.64 (96.78)
 * Train Acc 96.777
 * Val Acc 96.958, Total time 0.24
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1128 (0.1128)	0.0722 (0.0722)	13.441 (13.441)	96.09 (96.09)
[87/88]	0.0379 (0.0394)	0.0012 (0.0021)	13.415 (13.438)	96.06 (96.86)
 * Train Acc 96.857
 * Val Acc 97.065, Total time 0.24
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 55.414, Total time 0.27
validation split name: 2
 * Val Acc 92.654, Total time 0.26
validation split name: 3
 * Val Acc 97.065, Total time 0.27
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1148 (0.1148)	0.0734 (0.0734)	14.841 (14.841)	40.62 (40.62)
[95/96]	0.0342 (0.0393)	0.0012 (0.0021)	13.414 (13.465)	95.65 (97.15)
 * Train Acc 97.152
 * Val Acc 97.885, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1348 (0.1348)	0.0912 (0.0912)	13.390 (13.390)	97.66 (97.66)
[95/96]	0.0342 (0.0398)	0.0012 (0.0024)	13.339 (13.347)	100.00 (98.87)
 * Train Acc 98.867
 * Val Acc 98.389, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1289 (0.1289)	0.0881 (0.0881)	13.405 (13.405)	96.88 (96.88)
[95/96]	0.0342 (0.0397)	0.0012 (0.0023)	13.361 (13.332)	95.65 (99.03)
 * Train Acc 99.031
 * Val Acc 98.389, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1174 (0.1174)	0.0749 (0.0749)	13.300 (13.300)	99.22 (99.22)
[95/96]	0.0342 (0.0394)	0.0012 (0.0022)	13.406 (13.343)	95.65 (99.07)
 * Train Acc 99.072
 * Val Acc 98.389, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 83.972, Total time 0.28
validation split name: 2
 * Val Acc 93.340, Total time 0.28
validation split name: 3
 * Val Acc 68.943, Total time 0.25
validation split name: 4
 * Val Acc 98.389, Total time 0.26
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1178 (0.1178)	0.0759 (0.0759)	14.863 (14.863)	57.81 (57.81)
[92/93]	0.0344 (0.0395)	0.0012 (0.0022)	13.543 (13.594)	91.67 (93.46)
 * Train Acc 93.458
 * Val Acc 95.008, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1122 (0.1122)	0.0716 (0.0716)	13.444 (13.444)	96.09 (96.09)
[92/93]	0.0343 (0.0393)	0.0012 (0.0021)	13.393 (13.478)	100.00 (95.31)
 * Train Acc 95.305
 * Val Acc 95.411, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1297 (0.1297)	0.0864 (0.0864)	13.480 (13.480)	94.53 (94.53)
[92/93]	0.0344 (0.0387)	0.0012 (0.0023)	13.416 (13.475)	100.00 (95.36)
 * Train Acc 95.364
 * Val Acc 94.352, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1193 (0.1193)	0.0786 (0.0786)	13.563 (13.563)	92.19 (92.19)
[92/93]	0.0341 (0.0394)	0.0011 (0.0023)	13.498 (13.469)	91.67 (95.56)
 * Train Acc 95.559
 * Val Acc 94.957, Total time 0.25
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 62.033, Total time 0.28
validation split name: 2
 * Val Acc 73.751, Total time 0.28
validation split name: 3
 * Val Acc 30.843, Total time 0.25
validation split name: 4
 * Val Acc 92.749, Total time 0.26
validation split name: 5
 * Val Acc 94.957, Total time 0.26
OrderedDict([('1', OrderedDict([('1', 99.90543735224587), ('2', 77.16312056737588), ('3', 55.413711583924346), ('4', 83.97163120567376), ('5', 62.033096926713945)])), ('2', OrderedDict([('2', 97.89422135161607), ('3', 92.65426052889325), ('4', 93.33986287952987), ('5', 73.75122428991185)])), ('3', OrderedDict([('3', 97.06510138740661), ('4', 68.94343649946639), ('5', 30.843116328708646)])), ('4', OrderedDict([('4', 98.38872104733132), ('5', 92.74924471299094)])), ('5', OrderedDict([('5', 94.95713565305093)]))])
Task 1 average acc: 99.90543735224587
Task 2 average acc: 87.52867095949597
Task 3 average acc: 81.71102450007474
Task 4 average acc: 86.16091290800034
Task 5 average acc: 70.86676358227525
===Summary of experiment repeats: 6 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157 72.80511903 70.06842808 70.86676358
  0.          0.          0.          0.        ]
mean: 42.55034045854347 std: 34.766038808614766
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1057 (0.1057)	0.0750 (0.0750)	43.423 (43.423)	55.47 (55.47)
[98/99]	0.0296 (0.0316)	0.0014 (0.0022)	7.353 (11.958)	43.80 (62.67)
 * Train Acc 62.669
 * Val Acc 53.712, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1113 (0.1113)	0.0804 (0.0804)	7.325 (7.325)	50.00 (50.00)
[98/99]	0.0292 (0.0316)	0.0011 (0.0022)	6.938 (7.080)	100.00 (80.99)
 * Train Acc 80.987
 * Val Acc 99.669, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1124 (0.1124)	0.0804 (0.0804)	6.987 (6.987)	99.22 (99.22)
[98/99]	0.0290 (0.0315)	0.0009 (0.0021)	6.624 (6.698)	100.00 (99.78)
 * Train Acc 99.779
 * Val Acc 99.905, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1116 (0.1116)	0.0798 (0.0798)	6.640 (6.640)	99.22 (99.22)
[98/99]	0.0295 (0.0316)	0.0012 (0.0023)	6.647 (6.626)	99.17 (99.86)
 * Train Acc 99.858
 * Val Acc 99.905, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.905, Total time 0.34
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1489 (0.1489)	0.1029 (0.1029)	14.981 (14.981)	38.28 (38.28)
[94/95]	0.0357 (0.0439)	0.0013 (0.0028)	13.524 (13.642)	96.49 (92.41)
 * Train Acc 92.406
 * Val Acc 97.013, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1195 (0.1195)	0.0780 (0.0780)	13.455 (13.455)	97.66 (97.66)
[94/95]	0.0372 (0.0406)	0.0013 (0.0022)	13.332 (13.429)	100.00 (97.05)
 * Train Acc 97.047
 * Val Acc 97.502, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1309 (0.1309)	0.0875 (0.0875)	13.427 (13.427)	96.88 (96.88)
[94/95]	0.0357 (0.0406)	0.0013 (0.0024)	13.351 (13.391)	98.25 (97.23)
 * Train Acc 97.229
 * Val Acc 97.747, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1318 (0.1318)	0.0883 (0.0883)	13.397 (13.397)	96.09 (96.09)
[94/95]	0.0350 (0.0410)	0.0014 (0.0025)	13.354 (13.363)	100.00 (97.44)
 * Train Acc 97.444
 * Val Acc 97.551, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 77.021, Total time 0.31
validation split name: 2
 * Val Acc 97.551, Total time 0.29
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1375 (0.1375)	0.0908 (0.0908)	14.136 (14.136)	65.62 (65.62)
[87/88]	0.0381 (0.0419)	0.0013 (0.0027)	13.499 (13.615)	96.85 (90.97)
 * Train Acc 90.970
 * Val Acc 95.571, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1737 (0.1737)	0.1262 (0.1262)	13.486 (13.486)	96.88 (96.88)
[87/88]	0.0384 (0.0422)	0.0015 (0.0029)	13.496 (13.485)	96.06 (95.75)
 * Train Acc 95.747
 * Val Acc 96.265, Total time 0.28
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1201 (0.1201)	0.0758 (0.0758)	13.454 (13.454)	97.66 (97.66)
[87/88]	0.0388 (0.0418)	0.0014 (0.0024)	13.422 (13.469)	96.85 (96.49)
 * Train Acc 96.493
 * Val Acc 96.692, Total time 0.32
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1421 (0.1421)	0.0993 (0.0993)	13.420 (13.420)	98.44 (98.44)
[87/88]	0.0403 (0.0414)	0.0013 (0.0027)	13.469 (13.468)	95.28 (96.74)
 * Train Acc 96.742
 * Val Acc 96.798, Total time 0.35
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 69.551, Total time 0.28
validation split name: 2
 * Val Acc 87.463, Total time 0.28
validation split name: 3
 * Val Acc 96.798, Total time 0.25
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1245 (0.1245)	0.0818 (0.0818)	14.566 (14.566)	46.09 (46.09)
[95/96]	0.0354 (0.0402)	0.0014 (0.0024)	13.352 (13.475)	100.00 (97.05)
 * Train Acc 97.053
 * Val Acc 98.187, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1314 (0.1314)	0.0881 (0.0881)	13.408 (13.408)	99.22 (99.22)
[95/96]	0.0395 (0.0414)	0.0014 (0.0025)	13.301 (13.364)	100.00 (99.13)
 * Train Acc 99.130
 * Val Acc 98.590, Total time 0.31
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1219 (0.1219)	0.0786 (0.0786)	13.379 (13.379)	98.44 (98.44)
[95/96]	0.0371 (0.0418)	0.0018 (0.0024)	13.319 (13.347)	100.00 (99.25)
 * Train Acc 99.253
 * Val Acc 98.540, Total time 0.34
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1348 (0.1348)	0.0898 (0.0898)	13.360 (13.360)	100.00 (100.00)
[95/96]	0.0359 (0.0424)	0.0014 (0.0025)	13.340 (13.341)	100.00 (99.34)
 * Train Acc 99.343
 * Val Acc 98.540, Total time 0.30
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 85.626, Total time 0.30
validation split name: 2
 * Val Acc 92.214, Total time 0.28
validation split name: 3
 * Val Acc 70.277, Total time 0.26
validation split name: 4
 * Val Acc 98.540, Total time 0.27
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1196 (0.1196)	0.0781 (0.0781)	15.008 (15.008)	54.69 (54.69)
[92/93]	0.0345 (0.0396)	0.0011 (0.0023)	13.594 (13.607)	95.83 (93.46)
 * Train Acc 93.458
 * Val Acc 95.411, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1261 (0.1261)	0.0824 (0.0824)	13.509 (13.509)	94.53 (94.53)
[92/93]	0.0344 (0.0400)	0.0012 (0.0023)	13.550 (13.497)	91.67 (95.48)
 * Train Acc 95.483
 * Val Acc 94.957, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1162 (0.1162)	0.0736 (0.0736)	13.458 (13.458)	96.88 (96.88)
[92/93]	0.0346 (0.0396)	0.0013 (0.0022)	13.517 (13.491)	95.83 (95.56)
 * Train Acc 95.559
 * Val Acc 95.361, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1300 (0.1300)	0.0873 (0.0873)	13.542 (13.542)	93.75 (93.75)
[92/93]	0.0347 (0.0402)	0.0013 (0.0024)	13.500 (13.484)	91.67 (95.25)
 * Train Acc 95.254
 * Val Acc 95.159, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 63.310, Total time 0.27
validation split name: 2
 * Val Acc 78.746, Total time 0.27
validation split name: 3
 * Val Acc 36.286, Total time 0.25
validation split name: 4
 * Val Acc 96.777, Total time 0.26
validation split name: 5
 * Val Acc 95.159, Total time 0.25
OrderedDict([('1', OrderedDict([('1', 99.90543735224587), ('2', 77.02127659574468), ('3', 69.55082742316785), ('4', 85.62647754137116), ('5', 63.3096926713948)])), ('2', OrderedDict([('2', 97.55142017629775), ('3', 87.46327130264447), ('4', 92.21351616062684), ('5', 78.74632713026445)])), ('3', OrderedDict([('3', 96.7982924226254), ('4', 70.27748132337247), ('5', 36.28601921024546)])), ('4', OrderedDict([('4', 98.53977844914401), ('5', 96.77744209466263)])), ('5', OrderedDict([('5', 95.15885022692889)]))])
Task 1 average acc: 99.90543735224587
Task 2 average acc: 87.28634838602122
Task 3 average acc: 84.60413038281257
Task 4 average acc: 86.66431336862863
Task 5 average acc: 74.05566626669926
===Summary of experiment repeats: 7 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157 72.80511903 70.06842808 70.86676358
 74.05566627  0.          0.          0.        ]
mean: 49.95590708521339 std: 32.74202873210622
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1216 (0.1216)	0.0905 (0.0905)	43.108 (43.108)	43.75 (43.75)
[98/99]	0.0292 (0.0319)	0.0009 (0.0023)	7.335 (11.895)	45.45 (46.88)
 * Train Acc 46.877
 * Val Acc 46.336, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1139 (0.1139)	0.0822 (0.0822)	7.324 (7.324)	45.31 (45.31)
[98/99]	0.0293 (0.0318)	0.0011 (0.0022)	6.992 (7.057)	46.28 (46.77)
 * Train Acc 46.767
 * Val Acc 46.336, Total time 0.29
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1135 (0.1135)	0.0820 (0.0820)	6.971 (6.971)	48.44 (48.44)
[98/99]	0.0296 (0.0318)	0.0013 (0.0023)	6.999 (6.995)	46.28 (46.77)
 * Train Acc 46.767
 * Val Acc 46.336, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1086 (0.1086)	0.0776 (0.0776)	6.925 (6.925)	57.03 (57.03)
[98/99]	0.0300 (0.0317)	0.0013 (0.0022)	6.967 (6.991)	99.17 (82.61)
 * Train Acc 82.606
 * Val Acc 99.764, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.764, Total time 0.28
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1294 (0.1294)	0.0866 (0.0866)	14.312 (14.312)	46.09 (46.09)
[94/95]	0.0355 (0.0405)	0.0015 (0.0025)	13.699 (13.880)	96.49 (68.70)
 * Train Acc 68.699
 * Val Acc 96.082, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1181 (0.1181)	0.0767 (0.0767)	13.766 (13.766)	97.66 (97.66)
[94/95]	0.0351 (0.0399)	0.0009 (0.0023)	13.766 (13.714)	96.49 (96.26)
 * Train Acc 96.261
 * Val Acc 97.502, Total time 0.29
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1152 (0.1152)	0.0739 (0.0739)	13.700 (13.700)	98.44 (98.44)
[94/95]	0.0357 (0.0400)	0.0015 (0.0023)	13.398 (13.578)	96.49 (96.79)
 * Train Acc 96.790
 * Val Acc 96.719, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1311 (0.1311)	0.0865 (0.0865)	13.424 (13.424)	96.09 (96.09)
[94/95]	0.0353 (0.0403)	0.0014 (0.0024)	13.339 (13.395)	100.00 (97.25)
 * Train Acc 97.254
 * Val Acc 97.551, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 68.842, Total time 0.27
validation split name: 2
 * Val Acc 97.551, Total time 0.27
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1280 (0.1280)	0.0843 (0.0843)	13.941 (13.941)	71.09 (71.09)
[87/88]	0.0386 (0.0404)	0.0014 (0.0025)	13.514 (13.559)	93.70 (91.88)
 * Train Acc 91.885
 * Val Acc 96.745, Total time 0.25
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1364 (0.1364)	0.0926 (0.0926)	13.459 (13.459)	95.31 (95.31)
[87/88]	0.0383 (0.0405)	0.0013 (0.0027)	13.416 (13.452)	94.49 (96.68)
 * Train Acc 96.679
 * Val Acc 97.225, Total time 0.28
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1324 (0.1324)	0.0910 (0.0910)	13.396 (13.396)	97.66 (97.66)
[87/88]	0.0386 (0.0404)	0.0015 (0.0026)	13.481 (13.431)	96.06 (97.19)
 * Train Acc 97.194
 * Val Acc 97.759, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1308 (0.1308)	0.0886 (0.0886)	13.445 (13.445)	97.66 (97.66)
[87/88]	0.0391 (0.0406)	0.0014 (0.0027)	13.441 (13.427)	98.43 (97.53)
 * Train Acc 97.532
 * Val Acc 97.705, Total time 0.30
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 50.922, Total time 0.29
validation split name: 2
 * Val Acc 84.574, Total time 0.30
validation split name: 3
 * Val Acc 97.705, Total time 0.27
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1187 (0.1187)	0.0759 (0.0759)	14.555 (14.555)	49.22 (49.22)
[95/96]	0.0345 (0.0396)	0.0012 (0.0022)	13.371 (13.469)	95.65 (97.46)
 * Train Acc 97.455
 * Val Acc 98.792, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1170 (0.1170)	0.0749 (0.0749)	13.358 (13.358)	99.22 (99.22)
[95/96]	0.0344 (0.0395)	0.0012 (0.0022)	13.290 (13.347)	100.00 (99.47)
 * Train Acc 99.475
 * Val Acc 98.691, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1253 (0.1253)	0.0825 (0.0825)	13.331 (13.331)	100.00 (100.00)
[95/96]	0.0345 (0.0399)	0.0012 (0.0023)	13.362 (13.327)	100.00 (99.47)
 * Train Acc 99.466
 * Val Acc 98.792, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1145 (0.1145)	0.0717 (0.0717)	13.338 (13.338)	99.22 (99.22)
[95/96]	0.0347 (0.0399)	0.0012 (0.0022)	13.333 (13.345)	100.00 (99.50)
 * Train Acc 99.499
 * Val Acc 98.691, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 70.922, Total time 0.29
validation split name: 2
 * Val Acc 91.969, Total time 0.27
validation split name: 3
 * Val Acc 65.208, Total time 0.25
validation split name: 4
 * Val Acc 98.691, Total time 0.27
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1200 (0.1200)	0.0767 (0.0767)	14.623 (14.623)	57.03 (57.03)
[92/93]	0.0343 (0.0400)	0.0012 (0.0024)	13.480 (13.541)	91.67 (94.76)
 * Train Acc 94.763
 * Val Acc 96.167, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1304 (0.1304)	0.0896 (0.0896)	13.438 (13.438)	96.09 (96.09)
[92/93]	0.0356 (0.0398)	0.0013 (0.0024)	13.381 (13.466)	100.00 (96.46)
 * Train Acc 96.458
 * Val Acc 95.562, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1344 (0.1344)	0.0926 (0.0926)	13.411 (13.411)	97.66 (97.66)
[92/93]	0.0344 (0.0399)	0.0012 (0.0024)	13.507 (13.451)	91.67 (96.62)
 * Train Acc 96.619
 * Val Acc 96.420, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1264 (0.1264)	0.0835 (0.0835)	13.383 (13.383)	99.22 (99.22)
[92/93]	0.0359 (0.0398)	0.0014 (0.0023)	13.410 (13.451)	100.00 (96.50)
 * Train Acc 96.500
 * Val Acc 96.067, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 49.882, Total time 0.29
validation split name: 2
 * Val Acc 75.759, Total time 0.27
validation split name: 3
 * Val Acc 34.845, Total time 0.27
validation split name: 4
 * Val Acc 96.475, Total time 0.29
validation split name: 5
 * Val Acc 96.067, Total time 0.26
OrderedDict([('1', OrderedDict([('1', 99.76359338061465), ('2', 68.84160756501183), ('3', 50.92198581560284), ('4', 70.92198581560284), ('5', 49.881796690307326)])), ('2', OrderedDict([('2', 97.55142017629775), ('3', 84.5739471106758), ('4', 91.96865817825662), ('5', 75.7590597453477)])), ('3', OrderedDict([('3', 97.70544290288154), ('4', 65.20811099252936), ('5', 34.845250800426896)])), ('4', OrderedDict([('4', 98.6908358509567), ('5', 96.47532729103726)])), ('5', OrderedDict([('5', 96.06656580937972)]))])
Task 1 average acc: 99.76359338061465
Task 2 average acc: 83.1965138706548
Task 3 average acc: 77.73379194305339
Task 4 average acc: 81.69739770933637
Task 5 average acc: 70.60560006729978
===Summary of experiment repeats: 8 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157 72.80511903 70.06842808 70.86676358
 74.05566627 70.60560007  0.          0.        ]
mean: 57.016467091943376 std: 28.552944763022776
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1151 (0.1151)	0.0840 (0.0840)	43.142 (43.142)	54.69 (54.69)
[98/99]	0.0294 (0.0318)	0.0012 (0.0023)	7.324 (11.891)	50.41 (57.23)
 * Train Acc 57.229
 * Val Acc 53.712, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1177 (0.1177)	0.0864 (0.0864)	7.330 (7.330)	51.56 (51.56)
[98/99]	0.0293 (0.0318)	0.0012 (0.0023)	6.901 (7.039)	100.00 (80.47)
 * Train Acc 80.474
 * Val Acc 99.764, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1047 (0.1047)	0.0728 (0.0728)	6.929 (6.929)	100.00 (100.00)
[98/99]	0.0296 (0.0317)	0.0014 (0.0022)	6.622 (6.669)	100.00 (99.79)
 * Train Acc 99.795
 * Val Acc 99.905, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1051 (0.1051)	0.0731 (0.0731)	6.635 (6.635)	99.22 (99.22)
[98/99]	0.0293 (0.0315)	0.0011 (0.0021)	6.616 (6.621)	100.00 (99.89)
 * Train Acc 99.889
 * Val Acc 99.905, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.905, Total time 0.29
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1333 (0.1333)	0.0919 (0.0919)	14.707 (14.707)	45.31 (45.31)
[94/95]	0.0340 (0.0397)	0.0011 (0.0025)	13.484 (13.645)	96.49 (91.17)
 * Train Acc 91.174
 * Val Acc 96.817, Total time 0.31
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1419 (0.1419)	0.0986 (0.0986)	13.446 (13.446)	96.09 (96.09)
[94/95]	0.0344 (0.0397)	0.0012 (0.0024)	13.369 (13.422)	98.25 (96.96)
 * Train Acc 96.956
 * Val Acc 97.453, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1315 (0.1315)	0.0876 (0.0876)	13.424 (13.424)	96.09 (96.09)
[94/95]	0.0345 (0.0397)	0.0012 (0.0023)	13.418 (13.376)	94.74 (97.36)
 * Train Acc 97.361
 * Val Acc 97.600, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1300 (0.1300)	0.0893 (0.0893)	13.415 (13.415)	93.75 (93.75)
[94/95]	0.0345 (0.0396)	0.0012 (0.0024)	13.382 (13.351)	98.25 (97.53)
 * Train Acc 97.527
 * Val Acc 97.649, Total time 0.26
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 79.669, Total time 0.28
validation split name: 2
 * Val Acc 97.649, Total time 0.27
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1213 (0.1213)	0.0769 (0.0769)	13.866 (13.866)	75.00 (75.00)
[87/88]	0.0380 (0.0400)	0.0011 (0.0024)	13.591 (13.579)	93.70 (91.21)
 * Train Acc 91.210
 * Val Acc 95.945, Total time 0.25
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1187 (0.1187)	0.0755 (0.0755)	13.498 (13.498)	96.09 (96.09)
[87/88]	0.0390 (0.0398)	0.0012 (0.0023)	13.469 (13.458)	94.49 (96.10)
 * Train Acc 96.102
 * Val Acc 96.852, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1284 (0.1284)	0.0865 (0.0865)	13.443 (13.443)	96.88 (96.88)
[87/88]	0.0377 (0.0398)	0.0013 (0.0024)	13.436 (13.443)	97.64 (96.86)
 * Train Acc 96.857
 * Val Acc 97.065, Total time 0.24
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1222 (0.1222)	0.0810 (0.0810)	13.465 (13.465)	98.44 (98.44)
[87/88]	0.0379 (0.0397)	0.0012 (0.0023)	13.441 (13.447)	96.06 (97.06)
 * Train Acc 97.061
 * Val Acc 97.279, Total time 0.27
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 58.960, Total time 0.28
validation split name: 2
 * Val Acc 88.932, Total time 0.27
validation split name: 3
 * Val Acc 97.279, Total time 0.26
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1240 (0.1240)	0.0817 (0.0817)	14.490 (14.490)	49.22 (49.22)
[95/96]	0.0342 (0.0396)	0.0010 (0.0023)	13.366 (13.477)	100.00 (96.93)
 * Train Acc 96.930
 * Val Acc 98.036, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1315 (0.1315)	0.0888 (0.0888)	13.430 (13.430)	99.22 (99.22)
[95/96]	0.0346 (0.0399)	0.0014 (0.0024)	13.387 (13.377)	100.00 (99.04)
 * Train Acc 99.040
 * Val Acc 98.590, Total time 0.28
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1302 (0.1302)	0.0894 (0.0894)	13.349 (13.349)	100.00 (100.00)
[95/96]	0.0342 (0.0398)	0.0013 (0.0024)	13.304 (13.342)	100.00 (99.23)
 * Train Acc 99.228
 * Val Acc 98.640, Total time 0.26
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1166 (0.1166)	0.0749 (0.0749)	13.305 (13.305)	100.00 (100.00)
[95/96]	0.0344 (0.0395)	0.0013 (0.0022)	13.317 (13.332)	100.00 (99.27)
 * Train Acc 99.269
 * Val Acc 98.792, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 82.648, Total time 0.28
validation split name: 2
 * Val Acc 92.899, Total time 0.28
validation split name: 3
 * Val Acc 69.691, Total time 0.26
validation split name: 4
 * Val Acc 98.792, Total time 0.28
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1135 (0.1135)	0.0721 (0.0721)	14.960 (14.960)	47.66 (47.66)
[92/93]	0.0345 (0.0399)	0.0011 (0.0023)	13.449 (13.605)	95.83 (93.48)
 * Train Acc 93.483
 * Val Acc 94.705, Total time 0.26
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1156 (0.1156)	0.0743 (0.0743)	13.463 (13.463)	96.09 (96.09)
[92/93]	0.0346 (0.0397)	0.0013 (0.0023)	13.714 (13.491)	91.67 (95.67)
 * Train Acc 95.669
 * Val Acc 95.058, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1261 (0.1261)	0.0846 (0.0846)	13.505 (13.505)	94.53 (94.53)
[92/93]	0.0344 (0.0398)	0.0012 (0.0024)	13.452 (13.485)	95.83 (95.81)
 * Train Acc 95.805
 * Val Acc 95.361, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1326 (0.1326)	0.0909 (0.0909)	13.513 (13.513)	93.75 (93.75)
[92/93]	0.0345 (0.0398)	0.0012 (0.0024)	13.474 (13.480)	91.67 (95.61)
 * Train Acc 95.610
 * Val Acc 95.260, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 61.135, Total time 0.28
validation split name: 2
 * Val Acc 74.976, Total time 0.27
validation split name: 3
 * Val Acc 32.924, Total time 0.26
validation split name: 4
 * Val Acc 96.928, Total time 0.29
validation split name: 5
 * Val Acc 95.260, Total time 0.26
OrderedDict([('1', OrderedDict([('1', 99.90543735224587), ('2', 79.66903073286052), ('3', 58.959810874704495), ('4', 82.64775413711584), ('5', 61.13475177304964)])), ('2', OrderedDict([('2', 97.64936336924583), ('3', 88.93241919686582), ('4', 92.89911851126347), ('5', 74.97551420176298)])), ('3', OrderedDict([('3', 97.2785485592316), ('4', 69.69050160085379), ('5', 32.924226254002136)])), ('4', OrderedDict([('4', 98.79154078549848), ('5', 96.92849949647533)])), ('5', OrderedDict([('5', 95.25970751386788)]))])
Task 1 average acc: 99.90543735224587
Task 2 average acc: 88.65919705105318
Task 3 average acc: 81.72359287693398
Task 4 average acc: 86.00722875868288
Task 5 average acc: 72.24453984783159
===Summary of experiment repeats: 9 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157 72.80511903 70.06842808 70.86676358
 74.05566627 70.60560007 72.24453985  0.        ]
mean: 64.24092107672654 std: 21.47509225319363
split_boundaries: [0, 2, 4, 6, 8, 10]
{'1': [0, 1], '2': [2, 3], '3': [4, 5], '4': [6, 7], '5': [8, 9]}
FF nsa
MLP(
  (nsa1): ProgammedController(
    (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
    (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
    (res_s): Linear(in_features=1024, out_features=1, bias=True)
    (p2ku): Linear(in_features=1024, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (nsa2): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=400, out_features=5, bias=True)
  )
  (linear): Sequential(
    (0): ProgammedController(
      (program_key_u): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_v): Linear(in_features=1024, out_features=50, bias=True)
      (program_key_s): Linear(in_features=1024, out_features=50, bias=True)
      (res_s): Linear(in_features=1024, out_features=1, bias=True)
      (p2ku): Linear(in_features=1024, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (1): ReLU(inplace=True)
    (2): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=400, out_features=5, bias=True)
    )
    (3): ReLU(inplace=True)
  )
  (last): ModuleDict(
    (All): ProgammedController(
      (program_key_u): Linear(in_features=400, out_features=50, bias=True)
      (program_key_v): Linear(in_features=400, out_features=50, bias=True)
      (program_key_s): Linear(in_features=400, out_features=50, bias=True)
      (res_s): Linear(in_features=400, out_features=1, bias=True)
      (p2ku): Linear(in_features=400, out_features=5, bias=True)
      (p2kv): Linear(in_features=2, out_features=5, bias=True)
    )
  )
  (nsa_last): ProgammedController(
    (program_key_u): Linear(in_features=400, out_features=50, bias=True)
    (program_key_v): Linear(in_features=400, out_features=50, bias=True)
    (program_key_s): Linear(in_features=400, out_features=50, bias=True)
    (res_s): Linear(in_features=400, out_features=1, bias=True)
    (p2ku): Linear(in_features=400, out_features=5, bias=True)
    (p2kv): Linear(in_features=2, out_features=5, bias=True)
  )
)
#parameter of model:  423539
no learnable params:  423539
Task order: ['1', '2', '3', '4', '5']
====================== 1 =======================
#reg_term: 0
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1123 (0.1123)	0.0805 (0.0805)	42.931 (42.931)	63.28 (63.28)
[98/99]	0.0295 (0.0317)	0.0013 (0.0022)	7.046 (11.814)	86.78 (62.02)
 * Train Acc 62.021
 * Val Acc 87.991, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1124 (0.1124)	0.0802 (0.0802)	7.044 (7.044)	89.06 (89.06)
[98/99]	0.0298 (0.0318)	0.0012 (0.0022)	7.006 (7.009)	100.00 (98.09)
 * Train Acc 98.089
 * Val Acc 99.716, Total time 0.28
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1035 (0.1035)	0.0721 (0.0721)	6.946 (6.946)	99.22 (99.22)
[98/99]	0.0295 (0.0317)	0.0013 (0.0022)	6.642 (6.707)	99.17 (99.79)
 * Train Acc 99.795
 * Val Acc 99.905, Total time 0.28
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/99]	0.1110 (0.1110)	0.0783 (0.0783)	6.625 (6.625)	99.22 (99.22)
[98/99]	0.0296 (0.0319)	0.0011 (0.0023)	6.627 (6.625)	100.00 (99.88)
 * Train Acc 99.882
 * Val Acc 99.905, Total time 0.30
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 99.905, Total time 0.28
====================== 2 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1217 (0.1217)	0.0781 (0.0781)	14.349 (14.349)	59.38 (59.38)
[94/95]	0.0358 (0.0399)	0.0013 (0.0023)	13.389 (13.636)	100.00 (92.00)
 * Train Acc 92.001
 * Val Acc 97.111, Total time 0.28
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1176 (0.1176)	0.0758 (0.0758)	13.460 (13.460)	99.22 (99.22)
[94/95]	0.0343 (0.0395)	0.0012 (0.0022)	13.373 (13.432)	98.25 (96.92)
 * Train Acc 96.923
 * Val Acc 97.405, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1355 (0.1355)	0.0920 (0.0920)	13.470 (13.470)	95.31 (95.31)
[94/95]	0.0341 (0.0398)	0.0014 (0.0024)	13.398 (13.393)	98.25 (97.25)
 * Train Acc 97.254
 * Val Acc 97.551, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/95]	0.1210 (0.1210)	0.0778 (0.0778)	13.382 (13.382)	96.09 (96.09)
[94/95]	0.0344 (0.0397)	0.0013 (0.0023)	13.334 (13.371)	100.00 (97.40)
 * Train Acc 97.403
 * Val Acc 97.992, Total time 0.29
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 76.879, Total time 0.29
validation split name: 2
 * Val Acc 97.992, Total time 0.29
====================== 3 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1265 (0.1265)	0.0830 (0.0830)	14.145 (14.145)	66.41 (66.41)
[87/88]	0.0383 (0.0401)	0.0010 (0.0024)	13.544 (13.601)	92.13 (91.78)
 * Train Acc 91.778
 * Val Acc 96.211, Total time 0.25
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1155 (0.1155)	0.0744 (0.0744)	13.461 (13.461)	96.88 (96.88)
[87/88]	0.0381 (0.0396)	0.0013 (0.0022)	13.490 (13.457)	95.28 (96.36)
 * Train Acc 96.360
 * Val Acc 96.745, Total time 0.26
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1567 (0.1567)	0.1168 (0.1168)	13.483 (13.483)	96.09 (96.09)
[87/88]	0.0380 (0.0400)	0.0013 (0.0027)	13.476 (13.443)	96.06 (96.71)
 * Train Acc 96.706
 * Val Acc 97.065, Total time 0.25
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/88]	0.1122 (0.1122)	0.0719 (0.0719)	13.401 (13.401)	98.44 (98.44)
[87/88]	0.0380 (0.0397)	0.0012 (0.0023)	13.389 (13.446)	98.43 (96.87)
 * Train Acc 96.866
 * Val Acc 96.852, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 60.520, Total time 0.28
validation split name: 2
 * Val Acc 88.345, Total time 0.30
validation split name: 3
 * Val Acc 96.852, Total time 0.26
====================== 4 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1217 (0.1217)	0.0799 (0.0799)	14.436 (14.436)	51.56 (51.56)
[95/96]	0.0356 (0.0399)	0.0012 (0.0023)	13.366 (13.453)	100.00 (97.09)
 * Train Acc 97.094
 * Val Acc 98.288, Total time 0.27
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1224 (0.1224)	0.0792 (0.0792)	13.402 (13.402)	98.44 (98.44)
[95/96]	0.0343 (0.0397)	0.0012 (0.0023)	13.317 (13.351)	100.00 (99.09)
 * Train Acc 99.089
 * Val Acc 98.540, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1329 (0.1329)	0.0922 (0.0922)	13.338 (13.338)	100.00 (100.00)
[95/96]	0.0338 (0.0398)	0.0013 (0.0024)	13.299 (13.336)	100.00 (99.10)
 * Train Acc 99.097
 * Val Acc 98.590, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/96]	0.1282 (0.1282)	0.0873 (0.0873)	13.336 (13.336)	100.00 (100.00)
[95/96]	0.0346 (0.0396)	0.0013 (0.0023)	13.329 (13.348)	100.00 (99.21)
 * Train Acc 99.212
 * Val Acc 98.439, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 84.444, Total time 0.29
validation split name: 2
 * Val Acc 94.025, Total time 0.26
validation split name: 3
 * Val Acc 72.092, Total time 0.26
validation split name: 4
 * Val Acc 98.439, Total time 0.28
====================== 5 =======================
#reg_term: 1
Epoch:0
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1297 (0.1297)	0.0873 (0.0873)	15.303 (15.303)	51.56 (51.56)
[92/93]	0.0348 (0.0396)	0.0014 (0.0024)	13.427 (13.636)	100.00 (93.36)
 * Train Acc 93.356
 * Val Acc 94.352, Total time 0.29
Epoch:1
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1246 (0.1246)	0.0818 (0.0818)	13.465 (13.465)	97.66 (97.66)
[92/93]	0.0344 (0.0394)	0.0014 (0.0023)	13.463 (13.502)	91.67 (95.24)
 * Train Acc 95.237
 * Val Acc 94.856, Total time 0.27
Epoch:2
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1217 (0.1217)	0.0804 (0.0804)	13.509 (13.509)	94.53 (94.53)
[92/93]	0.0350 (0.0395)	0.0012 (0.0024)	13.481 (13.491)	95.83 (95.19)
 * Train Acc 95.195
 * Val Acc 94.907, Total time 0.27
Epoch:3
LR: 0.001
Itr		Time		  Data		  Loss		Acc
[0/93]	0.1299 (0.1299)	0.0879 (0.0879)	13.539 (13.539)	96.09 (96.09)
[92/93]	0.0348 (0.0396)	0.0013 (0.0024)	13.447 (13.482)	100.00 (95.32)
 * Train Acc 95.322
 * Val Acc 93.696, Total time 0.28
Computing EWC
Sample 60000 for estimating the F matrix.
validation split name: 1
 * Val Acc 69.314, Total time 0.29
validation split name: 2
 * Val Acc 80.999, Total time 0.29
validation split name: 3
 * Val Acc 37.513, Total time 0.27
validation split name: 4
 * Val Acc 95.921, Total time 0.26
validation split name: 5
 * Val Acc 93.696, Total time 0.26
OrderedDict([('1', OrderedDict([('1', 99.90543735224587), ('2', 76.87943262411348), ('3', 60.520094562647756), ('4', 84.44444444444444), ('5', 69.31442080378251)])), ('2', OrderedDict([('2', 97.99216454456415), ('3', 88.34476003917727), ('4', 94.0254652301665), ('5', 80.99902056807052)])), ('3', OrderedDict([('3', 96.85165421558165), ('4', 72.09178228388474), ('5', 37.51334044823906)])), ('4', OrderedDict([('4', 98.43907351460221), ('5', 95.9214501510574)])), ('5', OrderedDict([('5', 93.69641956631366)]))])
Task 1 average acc: 99.90543735224587
Task 2 average acc: 87.43579858433881
Task 3 average acc: 81.90550293913556
Task 4 average acc: 87.25019136827449
Task 5 average acc: 75.48893030749264
===Summary of experiment repeats: 10 / 10 ===
The regularization coefficient: 700.0
The last avg acc of all repeats: [70.66602171 68.10491061 72.99216157 72.80511903 70.06842808 70.86676358
 74.05566627 70.60560007 72.24453985 75.48893031]
mean: 71.78981410747579 std: 2.0386216864346047
reg_coef: 700.0 mean: 71.78981410747579 std: 2.0386216864346047
